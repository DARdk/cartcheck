# ==============================================================================
# CartChef Agno Agent - AI Orchestration Service Environment Configuration
# ==============================================================================
# Copy this file to .env and fill in the required values

# ==============================================================================
# APPLICATION SETTINGS
# ==============================================================================
APP_NAME=CartChef Agno Agent
APP_VERSION=0.1.0
ENVIRONMENT=development
DEBUG=true

# Server settings
HOST=0.0.0.0
PORT=5000
WORKERS=1

# ==============================================================================
# AI MODEL CONFIGURATION
# ==============================================================================
# Primary AI provider (OpenAI)
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.1
OPENAI_TOP_P=0.95
OPENAI_FREQUENCY_PENALTY=0
OPENAI_PRESENCE_PENALTY=0

# Alternative providers
ANTHROPIC_API_KEY=your-anthropic-api-key
ANTHROPIC_MODEL=claude-3-sonnet-20240229

GOOGLE_AI_API_KEY=your-google-ai-api-key
GOOGLE_AI_MODEL=gemini-pro

# Model fallback configuration
ENABLE_MODEL_FALLBACK=true
FALLBACK_ORDER=["openai", "anthropic", "google"]

# ==============================================================================
# EMBEDDING CONFIGURATION
# ==============================================================================
# Embedding model for semantic memory
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536
EMBEDDING_BATCH_SIZE=100

# pgvector database for embeddings
VECTOR_DATABASE_URL=postgresql://cartchef:cartchef_dev@localhost:5432/cartchef
VECTOR_TABLE_NAME=semantic_memory
VECTOR_SIMILARITY_THRESHOLD=0.8

# ==============================================================================
# MEMORY SYSTEM CONFIGURATION
# ==============================================================================
# Short-term memory (Redis)
REDIS_URL=redis://localhost:6379/4
REDIS_PASSWORD=
MEMORY_TTL=3600  # 1 hour

# Long-term structured memory (Firestore)
FIREBASE_PROJECT_ID=cartchef-dev
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-@cartchef-dev.iam.gserviceaccount.com

# Memory configuration
MAX_SHORT_TERM_MEMORIES=1000
MAX_CONVERSATION_HISTORY=50
MEMORY_CLEANUP_INTERVAL=3600

# ==============================================================================
# AGENT ORCHESTRATION
# ==============================================================================
# Agent workflow configuration
MAX_AGENT_ITERATIONS=10
AGENT_TIMEOUT=300  # 5 minutes
ENABLE_PARALLEL_AGENTS=true
MAX_PARALLEL_AGENTS=3

# Agent types and capabilities
ENABLE_RECIPE_PARSING_AGENT=true
ENABLE_SHOPPING_LIST_AGENT=true
ENABLE_PREFERENCE_LEARNING_AGENT=true
ENABLE_SUBSTITUTION_AGENT=true

# ==============================================================================
# EXTERNAL SERVICE INTEGRATIONS
# ==============================================================================
# Backend API
BACKEND_API_URL=http://localhost:8000
BACKEND_API_KEY=your-backend-api-key
BACKEND_TIMEOUT=30

# MCP Server
MCP_SERVER_URL=http://localhost:3001
MCP_TIMEOUT=20
MCP_RETRIES=3

# ==============================================================================
# RECIPE PARSING AGENT
# ==============================================================================
# Recipe URL parsing configuration
RECIPE_PARSER_TIMEOUT=15
RECIPE_PARSER_RETRIES=3
RECIPE_PARSER_USER_AGENT=CartChef-Agent/1.0

# Supported recipe formats
SUPPORTED_RECIPE_SCHEMAS=["Recipe", "recipe", "Recipe_1"]
ENABLE_FALLBACK_PARSING=true

# Recipe validation
VALIDATE_PARSED_RECIPES=true
MIN_INGREDIENTS_COUNT=2
MIN_INSTRUCTIONS_COUNT=1

# ==============================================================================
# SHOPPING LIST OPTIMIZATION
# ==============================================================================
# Ingredient normalization
ENABLE_INGREDIENT_NORMALIZATION=true
ENABLE_UNIT_CONVERSION=true
ENABLE_QUANTITY_OPTIMIZATION=true

# Deduplication settings
SIMILARITY_THRESHOLD=0.9
MERGE_SIMILAR_INGREDIENTS=true
GROUP_BY_CATEGORY=true

# ==============================================================================
# PREFERENCE LEARNING
# ==============================================================================
# Learning algorithm settings
PREFERENCE_LEARNING_RATE=0.1
PREFERENCE_DECAY_FACTOR=0.95
MIN_INTERACTIONS_FOR_LEARNING=3

# Preference categories
ENABLE_BRAND_PREFERENCES=true
ENABLE_DIETARY_PREFERENCES=true
ENABLE_SEASONAL_PREFERENCES=true
ENABLE_PRICE_PREFERENCES=true

# Confidence thresholds
MIN_PREFERENCE_CONFIDENCE=0.6
STRONG_PREFERENCE_THRESHOLD=0.8

# ==============================================================================
# SUBSTITUTION ENGINE
# ==============================================================================
# Substitution logic
ENABLE_AUTOMATIC_SUBSTITUTIONS=true
SUBSTITUTION_CONFIDENCE_THRESHOLD=0.7
MAX_SUBSTITUTIONS_PER_ITEM=3

# Substitution categories
ENABLE_BRAND_SUBSTITUTION=true
ENABLE_SIZE_SUBSTITUTION=true
ENABLE_DIETARY_SUBSTITUTION=true
ENABLE_SEASONAL_SUBSTITUTION=false

# ==============================================================================
# LOGGING CONFIGURATION
# ==============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=logs/agno-agent.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# Agent-specific logging
LOG_AGENT_DECISIONS=true
LOG_MEMORY_OPERATIONS=false
LOG_MODEL_INTERACTIONS=true

# ==============================================================================
# PERFORMANCE TUNING
# ==============================================================================
# Request optimization
ENABLE_REQUEST_CACHING=true
CACHE_TTL=300  # 5 minutes
MAX_CONCURRENT_REQUESTS=10

# Model optimization
ENABLE_MODEL_CACHING=true
MODEL_CACHE_SIZE=100
BATCH_REQUESTS=true

# ==============================================================================
# ERROR HANDLING & RESILIENCE
# ==============================================================================
# Retry configuration
MAX_RETRIES=3
RETRY_DELAY=1000  # 1 second
EXPONENTIAL_BACKOFF=true

# Circuit breaker
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT=60  # 1 minute

# Fallback strategies
ENABLE_GRACEFUL_DEGRADATION=true
FALLBACK_TO_SIMPLE_LOGIC=true

# ==============================================================================
# MONITORING & TELEMETRY
# ==============================================================================
# Metrics collection
ENABLE_METRICS=true
METRICS_PORT=9092
METRICS_PATH=/metrics

# Performance monitoring
TRACK_RESPONSE_TIMES=true
TRACK_MODEL_USAGE=true
TRACK_MEMORY_USAGE=true

# External monitoring
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development

# ==============================================================================
# SECURITY CONFIGURATION
# ==============================================================================
# API security
API_KEY=your-agno-agent-api-key
ENABLE_API_KEY_VALIDATION=true

# Rate limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60  # 1 minute
RATE_LIMIT_BY_API_KEY=true

# ==============================================================================
# DEVELOPMENT SETTINGS
# ==============================================================================
# Development mode
ENABLE_HOT_RELOAD=true
ENABLE_DEBUG_ENDPOINTS=true
MOCK_EXTERNAL_SERVICES=false

# Testing configuration
TEST_MODE=false
USE_MOCK_MODELS=false
ENABLE_AGENT_SIMULATION=false

# ==============================================================================
# WORKFLOW CONFIGURATION
# ==============================================================================
# Workflow orchestration
DEFAULT_WORKFLOW=recipe_to_cart
ENABLE_WORKFLOW_PERSISTENCE=true
WORKFLOW_TIMEOUT=600  # 10 minutes

# Step configuration
ENABLE_STEP_VALIDATION=true
ALLOW_STEP_SKIPPING=false
SAVE_INTERMEDIATE_RESULTS=true

# ==============================================================================
# DATA PRIVACY
# ==============================================================================
# Privacy settings
ANONYMIZE_USER_DATA=true
DATA_RETENTION_DAYS=90
ENABLE_DATA_ENCRYPTION=true

# GDPR compliance
ENABLE_RIGHT_TO_ERASURE=true
DATA_EXPORT_FORMAT=json