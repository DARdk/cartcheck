# ==============================================================================
# CartChef Backend - FastAPI Service Environment Configuration
# ==============================================================================
# Copy this file to .env and fill in the required values

# ==============================================================================
# APPLICATION SETTINGS
# ==============================================================================
APP_NAME=CartChef Backend API
APP_VERSION=0.1.0
APP_DESCRIPTION=Meal planning and grocery automation backend service
DEBUG=true
ENVIRONMENT=development

# Server settings
HOST=0.0.0.0
PORT=8000
RELOAD=true

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================
# PostgreSQL with pgvector extension
DATABASE_URL=postgresql://cartchef:cartchef_dev@localhost:5432/cartchef
DATABASE_ECHO=false
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# Redis for caching and background tasks
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_DB=0

# ==============================================================================
# AUTHENTICATION & SECURITY
# ==============================================================================
# JWT Configuration
SECRET_KEY=your-super-secret-key-change-this-in-production-minimum-32-chars
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password hashing
PWD_CONTEXT_SCHEMES=bcrypt
PWD_CONTEXT_DEPRECATED=auto

# CORS settings
CORS_ORIGINS=["http://localhost:3000", "http://localhost:3001"]
CORS_CREDENTIALS=true
CORS_METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]
CORS_HEADERS=["*"]

# ==============================================================================
# FIREBASE INTEGRATION
# ==============================================================================
# Firebase Admin SDK
FIREBASE_PROJECT_ID=cartchef-dev
FIREBASE_PRIVATE_KEY_ID=your-private-key-id
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-@cartchef-dev.iam.gserviceaccount.com
FIREBASE_CLIENT_ID=your-client-id
FIREBASE_AUTH_URI=https://accounts.google.com/o/oauth2/auth
FIREBASE_TOKEN_URI=https://oauth2.googleapis.com/token
FIREBASE_CLIENT_CERT_URL=https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-@cartchef-dev.iam.gserviceaccount.com

# Firestore settings
FIRESTORE_EMULATOR_HOST=localhost:8080

# ==============================================================================
# EXTERNAL API INTEGRATIONS
# ==============================================================================
# MCP Server for Nemlig integration
MCP_SERVER_URL=http://localhost:3001
MCP_SERVER_TIMEOUT=30
MCP_SERVER_RETRIES=3

# Agno Agent Framework
AGNO_AGENT_URL=http://localhost:5000
AGNO_AGENT_TIMEOUT=60

# ==============================================================================
# AI/ML CONFIGURATION
# ==============================================================================
# OpenAI API
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.1

# Embedding configuration for pgvector
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536
EMBEDDING_BATCH_SIZE=100

# ==============================================================================
# RATE LIMITING
# ==============================================================================
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60
RATE_LIMIT_STORAGE=redis

# ==============================================================================
# LOGGING CONFIGURATION
# ==============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=logs/backend.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# Structured logging (JSON format for production)
USE_JSON_LOGGING=false

# ==============================================================================
# CELERY CONFIGURATION (Background Tasks)
# ==============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true

# ==============================================================================
# FILE STORAGE
# ==============================================================================
# Local storage settings
UPLOAD_DIR=./uploads
TEMP_DIR=./temp
MAX_UPLOAD_SIZE=10485760  # 10MB

# Cloud storage (for production)
CLOUD_STORAGE_BUCKET=cartchef-uploads
CLOUD_STORAGE_PROJECT=cartchef-prod

# ==============================================================================
# MONITORING & HEALTH CHECKS
# ==============================================================================
# Health check endpoints
HEALTH_CHECK_TIMEOUT=5
HEALTH_CHECK_INTERVAL=30

# External monitoring
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Metrics and telemetry
ENABLE_METRICS=true
METRICS_PORT=9090

# ==============================================================================
# RECIPE PARSING CONFIGURATION
# ==============================================================================
# Recipe URL parsing settings
RECIPE_PARSER_TIMEOUT=10
RECIPE_PARSER_USER_AGENT=CartChef/1.0 (+https://cartchef.app)
RECIPE_PARSER_MAX_RETRIES=3

# Supported recipe schema formats
RECIPE_SCHEMA_TYPES=["Recipe", "recipe", "Recipe_1"]

# ==============================================================================
# TESTING CONFIGURATION
# ==============================================================================
# Test database (separate from development)
TEST_DATABASE_URL=postgresql://cartchef:cartchef_test@localhost:5432/cartchef_test
TEST_REDIS_URL=redis://localhost:6379/15

# Disable external APIs during testing
DISABLE_EXTERNAL_APIS=false
MOCK_EXTERNAL_SERVICES=true

# ==============================================================================
# DEVELOPMENT TOOLS
# ==============================================================================
# Auto-reload and debugging
AUTO_RELOAD=true
DEBUG_TOOLBAR=true

# API documentation
DOCS_URL=/docs
REDOC_URL=/redoc
OPENAPI_URL=/openapi.json